<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="CustomerStatSql">
	<!-- 通路别会员数统计-->
	<resultMap class="java.util.HashMap" id="getChannelCustStat">
		<result property="subchannelname" column="SUBCHANNELNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getChannelCustStats" resultMap="getChannelCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.subchannelname,
		   a.customercount,
		   a.pct_total
        from tb_channelcuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countChannelCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_channelcuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapChannelCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doChannelCustStat" parameterMap="mapChannelCustStat">
         {call pkg_cust.sp_channelcuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 商品别会员数统计-->
	<resultMap class="java.util.HashMap" id="getProductCustStat">
		<result property="productid" column="PRODUCTID" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="productname" column="PRODUCTNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="mdname" column="MDNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="purchasedcustcnt" column="PURCHASEDCUSTCNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getProductCustStats" resultMap="getProductCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.productid,
		   a.productname,
		   a.mdname,
		   a.purchasedcustcnt,
		   a.pct_total
        from tb_productcuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countProductCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_productcuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapProductCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doProductCustStat" parameterMap="mapProductCustStat">
         {call pkg_cust.sp_productcuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 行销活动别会员数统计-->
	<resultMap class="java.util.HashMap" id="getCampainCustStat">
		<result property="campaignno" column="CAMPAIGNNO" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="campaignname" column="CAMPAIGNNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="campaignstartdate" column="CAMPAIGNSTARTDATE" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="campaignenddate" column="CAMPAIGNENDDATE" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getCampainCustStats" resultMap="getCampainCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.campaignno,
		   a.campaignname,
		   to_char(a.campaignstartdate,'yyyy-mm-dd hh24:mi:ss') as campaignstartdate,
		   to_char(a.campaignenddate,'yyyy-mm-dd hh24:mi:ss') as campaignenddate,
		   a.customercount,
		   a.pct_total
        from tb_campaincuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countCampainCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_campaincuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapCampainCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doCampainCustStat" parameterMap="mapCampainCustStat">
         {call pkg_cust.sp_campaincuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员购买频次分布-->
	<resultMap class="java.util.HashMap" id="getBuytimeCustStat">
		<result property="quantity" column="QUANTITY" javaType="java.lang.Long" jdbcType="DECIMAL" nullValue="0"/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getBuytimeCustStats" resultMap="getBuytimeCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.quantity,
		   a.customercount,
		   a.pct_total
        from tb_buytimecuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countBuytimeCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_buytimecuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapBuytimeCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doBuytimeCustStat" parameterMap="mapBuytimeCustStat">
         {call pkg_cust.sp_buytimecuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员地区分布-->
	<resultMap class="java.util.HashMap" id="getAreaCustStat">
		<result property="province" column="PROVINCE" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="city" column="CITY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="area" column="AREA" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getAreaCustStats" resultMap="getAreaCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.province,
		   a.city,
		   a.area,
		   a.customercount,
		   a.pct_total
        from tb_areacuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by province,$sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countAreaCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_areacuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapAreaCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doAreaCustStat" parameterMap="mapAreaCustStat">
         {call pkg_cust.sp_areacuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员年龄结构分析-->
	<resultMap class="java.util.HashMap" id="getAgeCustStat">
		<result property="age" column="AGE" javaType="java.lang.Long" jdbcType="DECIMAL" nullValue="-1"/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getAgeCustStats" resultMap="getAgeCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.age,
		   a.customercount,
		   a.pct_total
        from tb_agecuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countAgeCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_agecuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapAgeCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doAgeCustStat" parameterMap="mapAgeCustStat">
         {call pkg_cust.sp_agecuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员性别结构分析-->
	<resultMap class="java.util.HashMap" id="getGendarCustStat">
		<result property="gender" column="GENDER" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getGendarCustStats" resultMap="getGendarCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   case a.gender when 'F' then '女' when 'M' then '男' when 'N' then '未知' else a.gender end as gender,
		   a.customercount,
		   a.pct_total
        from tb_gendarcuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countGendarCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_gendarcuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapGendarCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
         <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doGendarCustStat" parameterMap="mapGendarCustStat">
         {call pkg_cust.sp_gendarcuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员等级别会员统计-->
	<resultMap class="java.util.HashMap" id="getMemberLevelCustStat">
		<result property="membershiplevelname" column="MEMBERSHIPLEVELNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="totalamount" column="TOTALAMOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="totalmaoli" column="TOTALMAOLI" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getMemberLevelCustStats" resultMap="getMemberLevelCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.membershiplevelname,
		   a.customercount,
		   a.pct_total,
		   a.totalamount,
		   a.totalmaoli
        from tb_memberlevelcuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countMemberLevelCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_memberlevelcuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapMemberLevelCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doMemberLevelCustStat" parameterMap="mapMemberLevelCustStat">
         {call pkg_cust.sp_memberlevelcuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 呼叫人员会员接待数-->
	<resultMap class="java.util.HashMap" id="getCreatebyCustStat">
		<result property="createdby" column="CREATEDBY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="createdbyname" column="CREATEDBYNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getCreatebyCustStats" resultMap="getCreatebyCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.createdby,
		   (select USERNAME from tcmn_user where to_char(USERID) = a.createdby) as createdbyname,
		   a.customercount,
		   a.pct_total
        from tb_createbycuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countCreatebyCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_createbycuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapCreatebyCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doCreatebyCustStat" parameterMap="mapCreatebyCustStat">
         {call pkg_cust.sp_createbycuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员来源通路分布 -->
	<resultMap class="java.util.HashMap" id="getSourceChannelCustStat">
		<result property="subchannelname" column="SUBCHANNELNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="pct_total" column="pct_total" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
	</resultMap>
	<select id="getSourceChannelCustStats" resultMap="getSourceChannelCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.subchannelname,
		   a.customercount,
		   a.pct_total
        from tb_sourcechannelcuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countSourceChannelCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_sourcechannelcuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapSourceChannelCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="areaZipCodeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productClassId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="subchannelId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="campaignid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="actualEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStatusId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="excludereturnflag" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderCountMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderCountMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMin" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="orderMoneyMax" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doSourceChannelCustStat" parameterMap="mapSourceChannelCustStat">
         {call pkg_cust.sp_sourcechannelcuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 活跃会员数 -->
	<resultMap class="java.util.HashMap" id="getActiveCustStat">
		<result property="customercount" column="CUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="newcustomercount" column="NEWCUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="oldcustomercount" column="OLDCUSTOMERCOUNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getActiveCustStats" resultMap="getActiveCustStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.customercount,
		   a.newcustomercount,
		   a.oldcustomercount
        from tb_activecuststat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countActiveCustStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_activecuststat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapActiveCustStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="newCustomerDays"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="activeCycle"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="lossCycle"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="statCycle"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doActiveCustStat" parameterMap="mapActiveCustStat">
         {call pkg_cust.sp_activecuststat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 会员发展情况 -->
	<resultMap class="java.util.HashMap" id="getCustDevelopStat">
		<result property="time" column="TIME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="addedcustomercnt" column="ADDEDCUSTOMERCNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="lapsedcustomercnt" column="LAPSEDCUSTOMERCNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="activecustomercnt" column="ACTIVECUSTOMERCNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="avgdailyaddedcustcnt" column="AVGDAILYADDEDCUSTCNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
		<result property="avgdailylapsedcustcnt" column="AVGDAILYLAPSEDCUSTCNT" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getCustDevelopStats" resultMap="getCustDevelopStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.time,
		   a.addedcustomercnt,
		   a.lapsedcustomercnt,
		   a.activecustomercnt,
		   a.avgdailyaddedcustcnt,
		   a.avgdailylapsedcustcnt
        from tb_custdevelopstat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countCustDevelopStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_custdevelopstat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapCustDevelopStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="ageStart"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="ageEnd"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="sex" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="registerStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="registerEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="address" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN" nullValue=""/>
        <parameter property="newCustomerDays"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="activeCycle"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="lossCycle"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="statCycle"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" nullValue=""/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doCustDevelopStat" parameterMap="mapCustDevelopStat">
         {call pkg_cust.sp_custdevelopstat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 商品客诉统计 -->
	<resultMap class="java.util.HashMap" id="getProductComplaint">
		<result property="productid" column="PRODUCTID" javaType="java.lang.Long" jdbcType="DECIMAL" nullValue="-1"/>
		<result property="productname" column="PRODUCTNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="complaintquantity" column="COMPLAINTQUANTITY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getProductComplaints" resultMap="getProductComplaint" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.productid,
		   a.productname,
		   a.complaintquantity
        from tb_productcomplaint a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countProductComplaint" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_productcomplaint a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapProductComplaint" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="returnReasonId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="complaintCategoryId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doProductComplaint" parameterMap="mapProductComplaint">
         {call pkg_service.sp_productcomplaint(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 客诉主因统计 -->
	<resultMap class="java.util.HashMap" id="getComplaintResStat">
		<result property="complaintcategoryname" column="COMPLAINTCATEGORYNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="complaintquantity" column="COMPLAINTQUANTITY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getComplaintResStats" resultMap="getComplaintResStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.complaintcategoryname,
		   a.complaintquantity
        from tb_complaintresstat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countComplaintResStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_complaintresstat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapComplaintResStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="returnReasonId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="complaintCategoryId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doComplaintResStat" parameterMap="mapComplaintResStat">
         {call pkg_service.sp_complaintresstat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 商品客诉主因统计 -->
	<resultMap class="java.util.HashMap" id="getProdCompaintStat2">
		<result property="productid" column="PRODUCTID" javaType="java.lang.Long" jdbcType="DECIMAL" nullValue="-1"/>
		<result property="productname" column="PRODUCTNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="complaintcategoryname" column="COMPLAINTCATEGORYNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="complaintquantity" column="COMPLAINTQUANTITY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getProdCompaintStat2s" resultMap="getProdCompaintStat2" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.productid,
		   a.productname,
		   a.complaintcategoryname,
		   a.complaintquantity
        from tb_prodcompaintstat2 a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countProdCompaintStat2" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_prodcompaintstat2 a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapProdCompaintStat2" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="returnReasonId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="complaintCategoryId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doProdCompaintStat2" parameterMap="mapProdCompaintStat2">
         {call pkg_service.sp_prodcompaintstat2(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 客诉建立人客诉统计 -->
	<resultMap class="java.util.HashMap" id="getCreatebyComplaintStat">
		<result property="createdbyname" column="CREATEDBYNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="assignedcompquantity" column="ASSIGNEDCOMPQUANTITY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getCreatebyComplaintStats" resultMap="getCreatebyComplaintStat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.createdbyname,
		   a.assignedcompquantity
        from tb_createbycomplaintstat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countCreatebyComplaintStat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_createbycomplaintstat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapCreatebyComplaintStat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="returnReasonId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="complaintCategoryId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doCreatebyComplaintStat" parameterMap="mapCreatebyComplaintStat">
         {call pkg_service.sp_createbycomplaintstat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
	
	<!-- 供应商客诉统计 -->
	<resultMap class="java.util.HashMap" id="getSpcomplaintstat">
		<result property="suppliername" column="SUPPLIERNAME" javaType="java.lang.String" jdbcType="VARCHAR" nullValue=""/>
		<result property="complaintquantity" column="COMPLAINTQUANTITY" javaType="java.lang.String" jdbcType="VARCHAR" nullValue="0"/>
	</resultMap>
	<select id="getSpcomplaintstats" resultMap="getSpcomplaintstat" parameterClass="java.util.HashMap">
		<isGreaterThan property="endIndex" compareValue="0" >
			<![CDATA[
				select * from (select t_1.*,rownum as row_num from (
			]]>
		</isGreaterThan>
		select 
		   a.suppliername,
		   a.complaintquantity
        from tb_spcomplaintstat a
        where a.batchid = #userid#
        <isNotEmpty prepend="" property="sidx">
			order by $sidx$ $sord$
		</isNotEmpty>
        <isGreaterThan property="endIndex" compareValue="0">
			<![CDATA[
				) t_1 ) t_2 where t_2.row_num>=#startIndex# and t_2.row_num<=#endIndex#
			]]>
		</isGreaterThan>
	</select>
	
	<!-- 统计 -->
	<select id="countSpcomplaintstat" resultClass="java.lang.String" parameterClass="java.util.HashMap">
		select count(1) from tb_spcomplaintstat a where a.batchid = #userid#
	</select>
	
	<!-- 执行存储过程 -->
	<parameterMap id="mapSpcomplaintstat" class="java.util.HashMap">
        <parameter property="userid" javaType="java.lang.Long" jdbcType="DECIMAL"  mode="IN"/>
        <parameter property="username" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="userip" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="membershiplevelid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="customerTypeId" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="supplierid" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="suppliername" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="productname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderStartTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="orderEndTime" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="createbyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyids" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="handlebyname" javaType="java.lang.String" jdbcType="VARCHAR"  mode="IN"/>
        <parameter property="returnReasonId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="complaintCategoryId"  javaType="java.lang.String" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="resultcode"  javaType="java.lang.Integer" jdbcType="INTEGER" mode="OUT"/>
        <parameter property="errmesg"  javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT"/>
    </parameterMap>
    
	<procedure id="doSpcomplaintstat" parameterMap="mapSpcomplaintstat">
         {call pkg_service.sp_spcomplaintstat(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>
</sqlMap>